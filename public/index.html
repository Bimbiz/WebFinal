<!DOCTYPE html>
<html>
<head>
<title>Gaming Library</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container">

<h1>ðŸŽ® Gaming Library</h1>

<a href="login.html">Login</a> |
<a href="news.html">Gaming News</a>

<div class="card">
<h2>Add Game</h2>

<input id="title" placeholder="Title">
<input id="score" placeholder="User Score">
<input id="developer" placeholder="Developer ID">

<button onclick="addGame()">Add</button>
</div>


<div class="card">
<h2>Sort</h2>

<select onchange="loadGames(this.value)">
<option value="">Newest</option>
<option value="releaseDate">Release Date</option>
<option value="old">Oldest</option>
</select>

</div>

<div id="games"></div>

</div>


<script>

async function loadGames(sort=""){

let url = "http://localhost:5000/api/games";

if(sort){
    url += `?sortBy=${sort}`;
}

const res = await fetch(url);
const data = await res.json();

const gamesDiv = document.getElementById("games");
gamesDiv.innerHTML="";

data.games.forEach(game=>{

gamesDiv.innerHTML += `
<div class="card">
<h3>${game.title}</h3>
<p>Score: ${game.userScore}</p>
<p>Developer: ${game.developer?.name || "Unknown"}</p>

<button onclick="deleteGame('${game._id}')">Delete</button>
</div>
`;

});
}

async function addGame(){

await fetch("http://localhost:5000/api/games",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
title:document.getElementById("title").value,
userScore:document.getElementById("score").value,
developer:document.getElementById("developer").value
})
});

loadGames();
}

async function deleteGame(id){

await fetch(`http://localhost:5000/api/games/${id}`,{
method:"DELETE"
});

loadGames();
}

loadGames();

</script>

</body>
</html>
